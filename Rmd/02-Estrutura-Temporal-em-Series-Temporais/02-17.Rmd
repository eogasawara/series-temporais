---
title: "Aula 02 - Slide 17: Serie MA(1) e ACF"
output: html_document
---

## Objetivo
Gerar uma serie MA(1) e sua ACF para conectar choques passados ao padrao de dependencia.

## Conexao com o PDF
Slide 17 do PDF `02-Estrutura-Temporal-em-Series-Temporais.pdf`, arquivos de saida `slides/02-17a.png`, `slides/02-17b.png` e `slides/02-17.png`.

## Descricao do codigo
Simula um MA(1), plota a serie e a ACF, e concatena as imagens.

```{r setup, message=FALSE, warning=FALSE}
# Didatico: roteiro em 3 passos
# 1) Carregar dependencias/rotinas auxiliares.
# 2) Preparar dados e parametros do exemplo.
# 3) Gerar a figura/resultado esperado.
source("https://raw.githubusercontent.com/eogasawara/series-temporais/main/code/utils.R")
set.seed(217)
```

```{r gerar-figura}
# Didatico: roteiro em 3 passos
# 1) Carregar dependencias/rotinas auxiliares.
# 2) Preparar dados e parametros do exemplo.
# 3) Gerar a figura/resultado esperado.
n <- 250
theta <- 0.7

x <- arima.sim(model = list(ma = theta), n = n)
x_ts <- ts(x)

# (a) Serie MA(1)
p_a <- forecast::autoplot(x_ts) +
  ggplot2::labs(x = NULL, y = NULL, title = paste0("Serie MA(1) simulada (theta = ", theta, ")"))

fa <- har_slide_file("02", "17", "a")
har_ggsave_px(fa, p_a, height_px = TSED_HEIGHT)

# (b) ACF
fb <- har_slide_file("02", "17", "b")
grDevices::png(fb, width = TSED_WIDTH, height = TSED_HEIGHT, res = TSED_DPI)
stats::acf(x, main = "ACF do MA(1)")
grDevices::dev.off()

# Composicao final do slide
out <- har_slide_file("02", "17")
har_concat_png(out, c(fa, fb))
```

## Referencia
Hyndman, R.J., Athanasopoulos, G. (2021). Forecasting: Principles and Practice (3rd ed.). OTexts.

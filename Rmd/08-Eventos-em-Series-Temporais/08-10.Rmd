---
title: "Aula 08 - Slide 10"
output: html_document
---

## Objetivo
Reproduzir a figura/resultado do slide 10 da Aula 08.

## Descricao
Este documento explica o passo a passo do codigo para gerar a figura/resultado associado ao slide.

## Conexao com o PDF
Slide 10 do PDF correspondente da Aula 08.

## Referencia
Hyndman, R.J., Athanasopoulos, G. (2021). Forecasting: Principles and Practice (3rd ed.). OTexts.

```{r codigo, message=FALSE, warning=FALSE}
# Didatico: roteiro em 3 passos
# 1) Carregar dependencias/rotinas auxiliares.
# 2) Preparar dados e parametros do exemplo.
# 3) Gerar a figura/resultado esperado.
source("https://raw.githubusercontent.com/eogasawara/series-temporais/main/code/utils.R")

# Aula 08 — Slide 10: Discords
# Objetivo: mostrar discords como subsequências raras (as mais diferentes das demais).

suppressPackageStartupMessages({
  library(ggplot2)
})

set.seed(10)

# Série sintética: ruído + uma subsequência "estranha" (discord) inserida
n <- 320
t <- 1:n
x <- rnorm(n, sd=0.9)

# Discord (padrão raro) inserido
m <- 35
discord <- c(rep(0, m/2), seq(0, 4, length.out=m - m/2)) + rnorm(m, sd=0.2)
startD <- 170
idxD <- startD:(startD+m-1)
x[idxD] <- x[idxD] + discord

df <- data.frame(t=t, x=x)

p <- ggplot(df, aes(x=t, y=x)) +
  geom_line() +
  geom_rect(aes(xmin=min(idxD), xmax=max(idxD), ymin=-Inf, ymax=Inf), fill=NA, color="black", linetype="dashed", linewidth=0.5) +
  labs(
    x="t",
    y="x_t",
    title="Discord: subsequência rara destacada (padrão atípico)"
  )

har_ggsave_px(har_slide_file(08, 10), p)
```


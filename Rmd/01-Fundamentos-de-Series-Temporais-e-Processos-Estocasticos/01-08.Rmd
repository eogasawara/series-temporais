---
title: "Aula 01 - Slide 07: Media do processo temporal"
output: html_document
---

## Objetivo
Comparar uma serie com media constante e outra com mudanca de nivel.

## Descricao
Este documento explica o passo a passo do codigo para gerar a figura/resultado associado ao slide.

## Conexao com o PDF
Slide 07, arquivo de saida `figures/01-07.png` (concatena `01-07a.png` e `01-07b.png`).

```{r setup, message=FALSE, warning=FALSE}
# Didatico: roteiro em 3 passos
# 1) Carregar dependencias/rotinas auxiliares.
# 2) Preparar dados e parametros do exemplo.
# 3) Gerar a figura/resultado esperado.
source("https://raw.githubusercontent.com/eogasawara/series-temporais/main/code/utils.R")
set.seed(7)
```

```{r gerar-figuras}
# Didatico: roteiro em 3 passos
# 1) Carregar dependencias/rotinas auxiliares.
# 2) Preparar dados e parametros do exemplo.
# 3) Gerar a figura/resultado esperado.
T <- 200
t <- 1:T

# Serie 1: media constante
x_const <- rnorm(T, mean = 0, sd = 1)
x_const_ts <- ts(x_const, start = 1, frequency = 1)

p1 <- forecast::autoplot(x_const_ts) +
  ggplot2::labs(
    title = "Media constante",
    x = "t",
    y = expression(X[t])
  )

# Serie 2: media variavel (mudanca de nivel/regime)
mu <- ifelse(t <= T / 2, -1.0, 1.5)
x_var <- rnorm(T, mean = mu, sd = 1)
x_var_ts <- ts(x_var, start = 1, frequency = 1)

p2 <- forecast::autoplot(x_var_ts) +
  ggplot2::geom_vline(xintercept = T / 2, linetype = "dashed", alpha = 0.6) +
  ggplot2::labs(
    title = "Media variavel",
    x = "t",
    y = expression(X[t])
  )

har_ggsave_px(
  file = har_slide_file(1, 7, "a"),
  plot = p1,
  width_px = TSED_WIDTH,
  height_px = TSED_HEIGHT
)

har_ggsave_px(
  file = har_slide_file(1, 7, "b"),
  plot = p2,
  width_px = TSED_WIDTH,
  height_px = TSED_HEIGHT
)

har_concat_png(
  out_file = har_slide_file(1, 7),
  files = c(
    har_slide_file(1, 7, "a"),
    har_slide_file(1, 7, "b")
  )
)
```

## Referencia
Hyndman, R.J., Athanasopoulos, G. (2021). Forecasting: Principles and Practice (3rd ed.). OTexts.
